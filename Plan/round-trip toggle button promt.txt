Product Requirements Document (PRD) – Διορθωμένο & Οριστικό
Project: Σχεδιαστής Διαδρομής (Route Planner) – Ενίσχυση λειτουργίας “Round Trip”
Version: 2.0
Date: 2025-08-12
Prepared for: LLM-Code Implementation
────────────────────────────────────────

1. Στόχος
Να βελτιωθεί η εμπειρία χρήστη κατά την ενεργοποίηση της επιλογής “Κυκλική Διαδρομή” (round-trip) ώστε:
• Να είναι ξεκάθαρο το σημείο τερματισμού της διαδρομής, διακριτό από το αρχικό σημείο.
• Να μην υπάρχει επικάλυψη μεταξύ των pins.
• Να παρέχεται διαισθητικός τρόπος απενεργοποίησης της λειτουργίας.

2. Λειτουργίες προς υλοποίηση
2.1 Στυλ & θέση του round-trip pin
• Χρώμα: μωβ (#8B5CF6) για το round-trip pin.
• Δεν φέρει αριθμό· το εικονίδιο του θα είναι μία σημαία τερματισμού (Unicode: 🏁).
• Θέση: τοποθετείται ~10–15 m δεξιότερα και ελαφρώς κάτω από το αρχικό pin (offset ≈ [0.0001, 0.0001] σε lat/lng) ώστε να μην επικαλύπτεται και να είναι εύκολα διακριτό.

2.2 Λογική εμφάνισης
• Εμφανίζεται μόνον όταν το toggle “Κυκλική Διαδρομή” είναι ενεργοποιημένο και υπάρχουν ≥2 σημεία.
• Κατά την ενεργοποίηση του toggle:
  – Δημιουργείται νέο L.marker με τα παραπάνω χαρακτηριστικά.
  – Προστίθεται στον χάρτη ως roundTripMarker.
• Κατά την απενεργοποίηση του toggle ή την αλλαγή διαδρομής, το roundTripMarker αφαιρείται.

2.3 Δεξί κλικ στο round-trip pin
• Αν ο χρήστης κάνει δεξί κλικ σε απόσταση <20 m από το round-trip pin:
  – Το toggle “Κυκλική Διαδρομή” γίνεται un-checked.
  – Το roundTripMarker διαγράφεται από τον χάρτη.
  – Εμφανίζεται μήνυμα: “Η κυκλική διαδρομή απενεργοποιήθηκε.”
• Σε οποιοδήποτε άλλο σημείο, η υπάρχουσα λογική διαγραφής σημείων παραμένει ως έχει.

3. Τεχνικά σημεία εφαρμογής
3.1 CSS
• Προσθήκη κλάσης:
  .pin-icon.round-trip {
      background: #8B5CF6;
      border: 3px solid white;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.25);
  }

3.2 State
• roundTripMarker: L.marker | null
• roundTripOffset: L.latLng(0.0001, 0.0001)

3.3 Συναρτήσεις
• createRoundTripMarker(latlng) → L.marker
• removeRoundTripMarker()
• disableRoundTrip() – ενσωματώνει τα βήματα του §2.3

4. Edge cases
• Αν το αρχικό σημείο μετακινηθεί (drag), το roundTripMarker ενημερώνεται αυτόματα στην νέα θέση + offset.
• Κατά τον καθαρισμό όλης της διαδρομής, το roundTripMarker διαγράφεται μαζί με όλα τα pins.

5. Κριτήρια αποδοχής
• Το round-trip pin είναι ορατό και διακριτό.
• Το δεξί κλικ στο round-trip pin μόνο απενεργοποιεί την λειτουργία.
• Το αρχικό pin παραμένει ανέπαφο.

────────────────────────────────────────
End of PRD v2.0